<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Collection tests</title>
	<link rel="stylesheet" href="https://dev.mavo.io/dist/mavo.css" />
	<link rel="stylesheet" href="style.css" />
	<style>
		[mv-app="customitemcontrols"] .mv-item-bar {
			position: static;
			opacity: 1;
			border: 0;
			pointer-events: auto;
		}

		[property="hobby"] {
			padding: .5em;
			background: rgba(0,0,0,.1);
		}

		div[mv-multiple] {
			border: 1px solid rgba(0,0,0,.2);
			background: rgba(0,0,0,.1);
			padding: .5em;
			margin: .5em;
		}

		[mv-app="indexes"] div[mv-multiple] {
			display: flex;
			counter-increment: index;
			font-weight: bold;
		}

		[mv-app="indexes"] div[mv-multiple]::before,
		[mv-app="indexes"] div[mv-multiple]::after {
			content: attr(title);
			padding: .1em .5em;
			margin-right: .5em;
			background: black;
			color: white;
		}

		[mv-app="indexes"] div[mv-multiple]::before {
			margin-right: auto;
		}

		[mv-app="indexes"] div[mv-multiple]::after {
			content: counter(index);
			background: green;
			margin-left: auto;
		}

		[mv-app="indexes"] .mv-item-controls {
			position: static;
			opacity: 1;
			pointer-events: auto;
			border: 0;
			margin-left: auto;
		}
	</style>
	<script src="https://dev.mavo.io/dist/mavo.js"></script>
</head>
<body>

<h1>Collection tests</h1>

<script type="application/json" id="numbers">{
	"numbers": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
}</script>

<section mv-app="nested" mv-storage="#people" class="mv-autoedit">
	<h1>Nested collections</h1>
	<p>Use this to test dragging, both within a collection and to different collections.
	You should be able to drag across hobby lists or cats to people and vice versa, but not hobbies to people or people to hobbies.
	For the last reftest, click Save without making any changes.</p>

	<div property="person" mv-multiple mv-accepts="cat">
		<strong property="name">John Doe</strong>
		<ul>
			<li property="hobby" mv-multiple>Fishing</li>
		</ul>
	</div>
	<div property="cat" mv-multiple mv-accepts="person">
		<strong property="name">John Doe</strong>
		<ul>
			<li property="hobby" mv-multiple mv-related="hobby">Fishing</li>
		</ul>
	</div>

	<div>Another random div</div>

	<table class="reftest">
		<tr title="count(person)">
			<td>[count(person)]</td>
			<td>2</td>
		</tr>
		<tr title="count(cat)">
			<td>[count(cat)]</td>
			<td>2</td>
		</tr>
		<tr title="count(hobby)">
			<td>[count(hobby)]</td>
			<td>8</td>
		</tr>
		<tr mv-expressions="none" class="interactive">
			<td>
				<pre id="people">{
	"person": [
		{
			"name": "Lea Verou",
			"hobby": [
				"Coding",
				"Design",
				"Cooking"
			]
		},
		{
			"name": "David Karger",
			"hobby": [
				"Dancing",
				"Theory"
			]
		}
	],
	"cat": [
		{
			"name": "Vector",
			"hobby": [
				"Eating",
				"Purring"
			]
		},
		{
			"name": "Ã‡iki",
			"hobby": [
				"Playing"
			]
		}
	]
}</pre>
			</td>
			<td>
				<script>document.write($$("td pre").pop().outerHTML)</script>
			</td>
		</tr>
	</table>

</section>

<section mv-app="primitives" mv-storage="#numbers">
	<h1>Collection of primitives</h1>
	<table class="reftest">
		<tr>
			<td>
				<div property="numbers" mv-multiple style="--prepend: '[numbers]'; --append: '[$index]';"></div>
			</td>
			<td>
				<div mv-multiple="" style="--prepend: '1'; --append: '0'">1</div><!--
				--><div mv-multiple="" style="--prepend: '2'; --append: '1'">2</div><!--
				--><div mv-multiple="" style="--prepend: '3'; --append: '2'">3</div><!--
				--><div mv-multiple="" style="--prepend: '4'; --append: '3'">4</div><!--
				--><div mv-multiple="" style="--prepend: '5'; --append: '4'">5</div><!--
				--><div mv-multiple="" style="--prepend: '6'; --append: '5'">6</div><!--
				--><div mv-multiple="" style="--prepend: '7'; --append: '6'">7</div><!--
				--><div mv-multiple="" style="--prepend: '8'; --append: '7'">8</div><!--
				--><div mv-multiple="" style="--prepend: '9'; --append: '8'">9</div><!--
				--><div mv-multiple="" style="--prepend: '10'; --append: '9'">10</div>
			</td>
		</tr>
		<tr>
			<td>[numbers]</td>
			<td>1, 2, 3, 4, 5, 6, 7, 8, 9, 10</td>
		</tr>
	</table>
</section>

<section mv-app="primitives" mv-storage="#numbers-2">
	<h1>Immutable collection of primitives</h1>
	<table class="reftest">
		<tr mv-expressions="none">
			<td>
				<pre id="numbers-2">{
	"numbers": [
		1,
		2,
		3,
		4,
		5,
		6,
		7,
		8,
		9,
		10
	]
}</pre>
			</td>
			<td>
				<script>document.write($$("td pre").pop().outerHTML)</script>
			</td>
		</tr>
		<tr>
			<td>
				<div property="numbers">11</div>
				<div property="numbers">12</div>
				<div property="numbers">13</div>
			</td>
			<td>
				<div>1</div>
				<div>2</div>
				<div>3</div>
			</td>
		</tr>
		<tr>
			<td>[numbers]</td>
			<td>1, 2, 3</td>
		</tr>
	</table>
</section>

<section mv-app mv-storage="#immutable">
	<h1>Immutable collection inside mutable collection</h1>

	<table class="reftest">
		<tr mv-expressions="none">
			<td>
				<pre id="immutable">{
	"collection": [
		{
			"prop1": [3, 4]
		},
		{
			"prop1": [5, 6]
		}
	]
}</pre>
			</td>
			<td>
				<script>document.write($$("td pre").pop().outerHTML)</script>
			</td>
		</tr>
		<tr>
			<td>
				<div property="collection" mv-multiple>
					<div property="prop1">1</div>
					<div property="prop1">2</div>
				</div>
			</td>
			<td>
				<div>3 4</div>
				<div>5 6</div>
			</td>
		</tr>
		<tr>
			<td>[prop1]</td>
			<td>3, 4, 5, 6</td>
		</tr>
	</table>
</section>

<section>
	<h1>Duplicate mv-multiple properties</h1>

	<table class="reftest">
		<tr>
			<td>
				<pre id="duplicates-data">{
	"prop1": [
		{
			"prop2": 1,
			"prop3": 2
		},
		{
			"prop2": 3,
			"prop3": 4
		},
		{
			"prop2": 5,
			"prop3": 6
		}
	]
}</pre>
			</td>
			<td>
				<script>document.write($$("td pre").pop().outerHTML)</script>
			</td>
		</tr>
		<tr title="First with mv-multiple, second without">
			<td mv-app mv-storage="#duplicates-data">
				<div property="prop1" mv-multiple>
					<div property="prop2"></div>
					<div property="prop3"></div>
				</div>
				<div property="prop1">
					<div property="prop2"></div>
					<div property="prop3"></div>
				</div>
			</td>
			<td>
				<div mv-multiple>1 2</div>
				3 4
				<div mv-multiple>5 6</div>
			</td>
		</tr>
		<tr title="First without mv-multiple, second with">
			<td mv-app mv-storage="#duplicates-data">
				<div property="prop1">
					<div property="prop2">7</div>
					<div property="prop3">8</div>
				</div>
				<div property="prop1" mv-multiple>
					<div property="prop2">9</div>
					<div property="prop3">10</div>
				</div>
			</td>
			<td>
				1 2
				<div mv-multiple>3 4</div>
				<div mv-multiple>5 6</div>
			</td>
		</tr>
		<tr title="Both with mv-multiple">
			<td mv-app mv-storage="#duplicates-data">
				<div property="prop1" mv-multiple>
					<div property="prop2"></div>
					<div property="prop3"></div>
				</div>
				<div property="prop1" mv-multiple>
					<div property="prop2"></div>
					<div property="prop3"></div>
				</div>
			</td>
			<td>
				<div mv-multiple>1 2</div>
				<div mv-multiple>3 4</div>
				<div mv-multiple>5 6</div>
			</td>
		</tr>
		<tr title="Both with mv-multiple, no render">
			<td mv-app>
				<div property="prop1" mv-multiple>
					<div property="prop2">7</div>
					<div property="prop3">8</div>
				</div>
				<div property="prop1" mv-multiple>
					<div property="prop2">9</div>
					<div property="prop3">10</div>
				</div>
			</td>
			<td>
				<div mv-multiple>7 8</div>
				<div mv-multiple>9 10</div>
			</td>
		</tr>
	</table>
</section>

<section mv-storage="local" mv-app id="collector" class="mv-autoedit">
	<h1>
		Collection with expressions and HTML comments
	</h1>

	<div property="book" mv-multiple>
		<!-- input a number of properties - use input type="range" to create a slider for the property "condition" - use expressions to translate this to the representation on a scale of 0 to 10 by single decimals
		--><p>Condition: [20/10]</p>
	</div>
</section>

<script type="application/json" id="indexes" mv-expressions="none">
{
	"number": [
		{"value": 1},
		{"value": 2},
		{"value": 3},
		{"value": 4},
		{"value": 5},
		{"value": 6},
		{"value": 7},
		{"value": 8},
		{"value": 9},
		{"value": 10}
	]
}
</script>
<section mv-app="indexes" mv-storage="#indexes" class="mv-autoedit">
	<h1>Indices</h1>
	<p>Drag and drop and see if indices stay correct. The numbers in the black squares must always match the numbers in the green squares.</p>
	<div property="number" mv-multiple title="[$index]">
		<span property="value"></span>
	</div>
</section>

<section mv-app="bottomup" mv-storage="#indexes" class="mv-autoedit">
	<h1>Bottom-up collections</h1>

	<div property="number" mv-multiple title="[$index]" mv-order="desc">
		<span property="value"></span>
	</div>
</section>

<script type="application/json" id="countries">{
	"country": [
		{
			"code": "",
			"name": "Online"
		},
		{
			"code": "us",
			"name": "United States"
		},
		{
			"code": "gb",
			"name": "United Kingdom"
		}
	]
}</script>
<section mv-app="customitemcontrols" mv-storage="#countries" class="mv-autoedit">
	<h1>Custom item bar placement</h1>
	<table class="reftest">
		<tr>
			<td>
				<div property="country" mv-multiple>
					<div class="mv-item-bar mv-ui">A</div>
					<span property="code"></span>
					<span property="name"></span>
				</div>
			</td>
			<td>
				<div mv-multiple><div class="mv-item-bar mv-ui">A</div> (Code) Online</div>
				<div mv-multiple><div class="mv-item-bar mv-ui">A</div> us United States</div>
				<div mv-multiple><div class="mv-item-bar mv-ui">A</div> gb United Kingdom </div>
			</td>
		</tr>
	</table>
</section>

<section>
	<h1>Collection of primitives, &lt;ul> root</h1>

	<ul mv-app="copur">
	    <li property="foo" mv-multiple>Foo</li>
	</ul>
</section>

<section mv-app="customadd" mv-storage="#indexes" class="mv-autoedit">
	<h1>Custom add button before collection</h1>

	<button class="mv-add-number">Another number</button>
	<div property="number" mv-multiple title="[$index]">
		<span property="value"></span>
	</div>
</section>

<section mv-app="custom-add" mv-storage="#indexes" class="mv-autoedit">
	<h1>Custom add button after collection</h1>

	<div property="number" mv-multiple title="[$index]">
		<span property="value"></span>
	</div>
	<button class="mv-add-number">Another number</button>
</section>

<section>
    <h1>Collections containing Boolean values</h1>

	<table class="reftest">
		<tr>
			<td>
				<pre id="boolcol-data">{
	"team": [
		{
			"name": "A",
			"isBest": false,
			"wins": [
				true,
				true,
				false
			]
		},
		{
			"name": "B",
			"isBest": true,
			"wins": [
				true,
				true,
				true
			]
		},
		{
			"name": "C",
			"isBest": false,
			"wins": [
				false,
				true,
				false
			]
		}
	]
}</pre>
			</td>
			<td>
				<script>document.write($$("td pre").pop().outerHTML)</script>
			</td>
		</tr>
		<tr>
			<td mv-app="bools" mv-storage="#boolcol-data">
				<div property="team" mv-multiple>
					<b property="name">name</b>
					<i property="isBest">is best</i>
					<ul>
						<li property="wins" mv-multiple>wins</li>
					</ul>
				</div>
			</td>
			<td>
				<div mv-multiple>A
					<ul>
						<li>wins</li><li>wins</li>
					</ul>
				</div>
				<div mv-multiple>B <i>is best</i>
					<ul>
						<li>wins</li><li>wins</li><li>wins</li>
					</ul>
				</ul></div>
				<div mv-multiple>C
					<ul>
						<li>wins</li>
					</ul>
				</div>
			</td>
		</tr>
	</table>
</section>

<section mv-app="shopping" mv-storage="#empty-data">
	<h1>Empty list</h1>

	<table class="reftest">
		<tr title="Count all items">
			<td>[count(product)]</td>
			<td>0</td>
		</tr>
		<tr title="Inside items">
			<td>Items: [bought]</td>
			<td>Items: </td>
		</tr>
		<tr title="Count inside items">
			<td>[count(bought)]</td>
			<td>0</td>
		</tr>
		<tr mv-expressions="none">
			<td>
				<pre id="empty-data">{
	"product": []
}</pre>
			</td>
			<td>
				<script>document.write($$("td pre").pop().outerHTML)</script>
			</td>
		</tr>
		<tr>
			<td>
				<ul>
					<li property="product" mv-multiple>
						<label>
							<input property="bought" type="checkbox" />
							<span property="name">Garlic</span>
						</label>
					</li>
				</ul>
			</td>
			<td></td>
		</tr>
	</table>
</section>

<script src="mavotest.js"></script>

</body>
</html>
